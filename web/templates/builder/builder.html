{% extends "base/base.html" %}
{% from "components/icons.html" import icon %}

{% block title %}Builder - LotRO Forge{% endblock %}

{% block extra_head %}
<script src="{{ url_for('static', path='js/database/core/base-filters.js') }}"></script>
{% endblock %}

{% block content %}
<div id="builder-component" class="w-full h-[calc(100vh-12rem)] -mx-6 -my-6 relative" x-data="panelManager()">
    <!-- Database Controller Wrapper -->
    <div id="database-controller" x-data="databaseController()">
        <!-- Builder Component -->
        <div id="build-state" 
            x-data="buildState"
            class="bg-lotro-darker h-full">
                
            <!-- Utility Panel Component -->
            {% include "builder/utility-panel.html" %}

            <!-- Debug Panel Component -->
            {% include "builder/debug-panel.html" %}

            <!-- Main content area -->
            <div class="w-full px-[5%] pt-6 pb-4 h-full flex items-start justify-center gap-0 relative">
                <!-- Main Character Sheet Section -->
                <div class="grid grid-cols-[130px_330px_1fr_460px] gap-0 p-4 items-start">
                    <!-- Invisible spacer column to balance layout -->
                    <div></div>
                    {% include "builder/sections/legendary_items.html" %}
                    {% include "builder/sections/character_info.html" %}
                    {% include "builder/sections/character_stats.html" %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Hide elements until Alpine.js is ready -->
<style>
    [x-cloak] { display: none !important; }
</style>

<!-- Builder JavaScript -->
<script src="{{ url_for('static', path='js/components/panel-manager.js') }}"></script>
<script src="{{ url_for('static', path='js/database/core/database-controller.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/build-state.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/models/item.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/models/equipment.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/models/essence.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/models/weapon.js') }}"></script>
<script src="{{ url_for('static', path='js/utils/build-event-dispatcher.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/equipment-manager.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/essence-manager.js') }}"></script>
<script src="{{ url_for('static', path='js/builder/stats-engine.js') }}"></script>
{% endblock %} 