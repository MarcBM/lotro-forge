{% extends "base/base.html" %}

{% block title %}Builder - LotRO Forge{% endblock %}

{% block content %}
</div>
</main>

<!-- Override the base template's main structure for full-width builder -->
<main class="flex-grow">
    <div class="w-full h-[calc(100vh-16rem)]">
<!-- Builder Component -->
<div id="builder-component" 
     x-data="{ 
         activePanel: null,
         init() {
             console.log('Builder component initialized with ID:', this.$el.id);
         },
         openPanel(panel) {
             console.log('Opening panel:', panel);
             this.activePanel = panel;
             document.body.style.overflow = 'hidden';
         },
         closePanel(panel) {
             console.log('Closing panel:', panel);
             if (this.activePanel === panel) {
                 this.activePanel = null;
                 document.body.style.overflow = '';
                 window.dispatchEvent(new CustomEvent('panel-closed'));
             }
         },
         closeAllPanels() {
             console.log('Closing all panels');
             this.activePanel = null;
             document.body.style.overflow = '';
             window.dispatchEvent(new CustomEvent('panel-closed'));
         }
     }"
     x-init="init()"
     @open-panel.window="openPanel($event.detail)"
             class="bg-lotro-darker h-full">
    
    <!-- Include panel components -->
    {% include "components/panels/legendary_panel.html" %}
    {% include "components/panels/traits_panel.html" %}
    {% include "components/panels/buffs_panel.html" %}
    {% include "components/panels/misc_panel.html" %}
    {% include "components/panels/optimise_panel.html" %}

            <!-- Main content area with outside spacers -->
            <div class="w-full px-[5%] py-4 h-full flex items-start justify-center gap-0 -mt-20">
                <!-- Left outside spacer - shows dark blue background -->
                <div class="w-60 h-full flex-grow"></div>
                
                <!-- Main Character Sheet Section -->
                <div class="bg-lotro-dark rounded-lg shadow-lg border border-lotro-border h-full relative max-w-[1400px] min-w-[1200px] max-h-[800px]">
                    <div class="grid grid-cols-[320px_1fr_450px] gap-5 p-4 h-full items-start justify-items-center">
                        {% include "builder/columns/legendary_items.html" %}
                        {% include "builder/columns/character_info.html" %}
                        {% include "builder/columns/character_stats.html" %}
                    </div>
                </div>

                <!-- Right outside spacer - shows dark blue background -->
                <div class="w-28 h-full flex-grow"></div>
            </div>
        </div>
    </div>
</div>

<!-- Hide elements until Alpine.js is ready -->
<style>
    [x-cloak] { display: none !important; }
</style>
{% endblock %} 